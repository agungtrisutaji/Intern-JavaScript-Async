<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AJAX</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th, td {
            padding: 8px 12px;
            border: 1px solid #ccc;
            text-align: left;
        }

        th {
            background-color: #27ae60;   /* Hijau hanya untuk header */
            color: white;
            font-weight: bold;
        }

        img {
            max-width: 80px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h2>Cari Film</h2>
    <input type="text" id="keyword" placeholder="Masukkan judul film">
    <button onclick="buttonClick()">Search Products</button>

    <div id="table-products"></div>

    <script>
        function getProductsUrl(keyword) {
            return `https://www.omdbapi.com/?apikey=dca61bcc&s=${encodeURIComponent(keyword)}`;
        }

        function getProducts(keyword, callbackSuccess, callbackError) {
            const ajax = new XMLHttpRequest();
            ajax.onload = function () {
                if (ajax.status === 200) {
                    const data = JSON.parse(ajax.responseText);
                    if (data.Response === "True") {
                        callbackSuccess(data);
                    } else {
                        callbackError();
                    }
                } else {
                    callbackError();
                }
            };
            ajax.open("GET", getProductsUrl(keyword));
            ajax.send();
        }

        function getProductsError() {
            alert("Error mengambil data film");
        }

        function clearTableProducts() {
            document.getElementById("table-products").textContent = "";
        }

        // === TABEL Judul | Tipe | Tahun | Poster ===
        function displayTableProducts(data) {
            const table = document.createElement("table");

            // Header
            const header = table.insertRow();
            ["Judul", "Tipe", "Tahun", "Poster"].forEach(text => {
                const th = document.createElement("th");
                th.textContent = text;
                header.appendChild(th);
            });

            // Isi tabel
            data.Search.forEach(movie => {
                const row = table.insertRow();

                row.insertCell().textContent = movie.Title;
                row.insertCell().textContent = movie.Type;
                row.insertCell().textContent = movie.Year;

                const cellPoster = row.insertCell();
                if (movie.Poster && movie.Poster !== "N/A") {
                    const img = document.createElement("img");
                    img.src = movie.Poster;
                    img.alt = movie.Title;
                    cellPoster.appendChild(img);
                } else {
                    cellPoster.textContent = "N/A";
                }
            });

            document.getElementById("table-products").appendChild(table);
        }

        function buttonClick() {
            const keyword = document.getElementById("keyword").value.trim();
            if (!keyword) {
                alert("Masukkan judul film");
                return;
            }

            getProducts(keyword, function (data) {
                clearTableProducts();
                displayTableProducts(data);
            }, getProductsError);
        }
    </script>
</body>
</html>
